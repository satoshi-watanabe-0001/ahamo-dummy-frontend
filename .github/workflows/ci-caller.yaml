name: CI Pipeline

on:
  push:
    branches:
      - dev
      - test
      - feature/*
      - 'devin/**'
    tags:
      - 'prod-*'
      - 'dev-*'
      - 'test-*'
  pull_request:
    branches:
      - main
      - dev
      - test

env:
  ENV: ${{ github.ref_name == 'dev' && 'dev' || github.ref_name == 'test' && 'test' || startsWith(github.ref, 'refs/tags/prod-') && 'prod' || 'dev' }}

jobs:
  ci:
    uses: satoshi-watanabe-0001/sample001/.github/workflows/ci-called.yaml@main
    with:
      ENV: ${{ env.ENV }}
      REPO_TYPE: "app"
      CONFIG_FILES: "ci-config.yaml"
    secrets: inherit
